!function(e,t,n){"use strict";!function a(e,t,n){function i(r,s){if(!t[r]){if(!e[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(o)return o(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var c=t[r]={exports:{}};e[r][0].call(c.exports,function(t){var n=e[r][1][t];return i(n?n:t)},c,c.exports,a,e,t,n)}return t[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)i(n[r]);return i}({1:[function(a,i,o){var r=function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(o,"__esModule",{value:!0});var s,l,d,c,u=a("./modules/handle-dom"),f=a("./modules/utils"),m=a("./modules/handle-swal-dom"),p=a("./modules/handle-click"),_=a("./modules/handle-key"),g=r(_),h=a("./modules/default-params"),v=r(h),x=a("./modules/set-params"),w=r(x);o["default"]=d=c=function(){function a(e){var t=i;return t[e]===n?v["default"][e]:t[e]}var i=arguments[0];if(u.addClass(t.body,"stop-scrolling"),m.resetInput(),i===n)return f.logStr("SweetAlert expects at least 1 attribute!"),!1;var o=f.extend({},v["default"]);switch(typeof i){case"string":o.title=i,o.text=arguments[1]||"",o.type=arguments[2]||"";break;case"object":if(i.title===n)return f.logStr('Missing "title" argument!'),!1;o.title=i.title;for(var r in v["default"])o[r]=a(r);o.confirmButtonText=o.showCancelButton?"Confirm":v["default"].confirmButtonText,o.confirmButtonText=a("confirmButtonText"),o.doneFunction=arguments[1]||null;break;default:return f.logStr('Unexpected type of argument! Expected "string" or "object", got '+typeof i),!1}w["default"](o),m.fixVerticalPosition(),m.openModal(arguments[1]);for(var d=m.getModal(),_=d.querySelectorAll("button"),h=["onclick","onmouseover","onmouseout","onmousedown","onmouseup","onfocus"],x=function(e){return p.handleButton(e,o,d)},y=0;y<_.length;y++)for(var b=0;b<h.length;b++){var k=h[b];_[y][k]=x}m.getOverlay().onclick=x,s=e.onkeydown;var E=function(e){return g["default"](e,o,d)};e.onkeydown=E,e.onfocus=function(){setTimeout(function(){l!==n&&(l.focus(),l=n)},0)},c.enableButtons()},d.setDefaults=c.setDefaults=function(e){if(!e)throw new Error("userParams is required");if("object"!=typeof e)throw new Error("userParams has to be a object");f.extend(v["default"],e)},d.close=c.close=function(){var a=m.getModal();u.fadeOut(m.getOverlay(),5),u.fadeOut(a,5),u.removeClass(a,"showSweetAlert"),u.addClass(a,"hideSweetAlert"),u.removeClass(a,"visible");var i=a.querySelector(".sa-icon.sa-success");u.removeClass(i,"animate"),u.removeClass(i.querySelector(".sa-tip"),"animateSuccessTip"),u.removeClass(i.querySelector(".sa-long"),"animateSuccessLong");var o=a.querySelector(".sa-icon.sa-error");u.removeClass(o,"animateErrorIcon"),u.removeClass(o.querySelector(".sa-x-mark"),"animateXMark");var r=a.querySelector(".sa-icon.sa-warning");return u.removeClass(r,"pulseWarning"),u.removeClass(r.querySelector(".sa-body"),"pulseWarningIns"),u.removeClass(r.querySelector(".sa-dot"),"pulseWarningIns"),setTimeout(function(){var e=a.getAttribute("data-custom-class");u.removeClass(a,e)},300),u.removeClass(t.body,"stop-scrolling"),e.onkeydown=s,e.previousActiveElement&&e.previousActiveElement.focus(),l=n,clearTimeout(a.timeout),!0},d.showInputError=c.showInputError=function(e){var t=m.getModal(),n=t.querySelector(".sa-input-error");u.addClass(n,"show");var a=t.querySelector(".sa-error-container");u.addClass(a,"show"),a.querySelector("p").innerHTML=e,setTimeout(function(){d.enableButtons()},1),t.querySelector("input").focus()},d.resetInputError=c.resetInputError=function(e){if(e&&13===e.keyCode)return!1;var t=m.getModal(),n=t.querySelector(".sa-input-error");u.removeClass(n,"show");var a=t.querySelector(".sa-error-container");u.removeClass(a,"show")},d.disableButtons=c.disableButtons=function(){var e=m.getModal(),t=e.querySelector("button.confirm"),n=e.querySelector("button.cancel");t.disabled=!0,n.disabled=!0},d.enableButtons=c.enableButtons=function(){var e=m.getModal(),t=e.querySelector("button.confirm"),n=e.querySelector("button.cancel");t.disabled=!1,n.disabled=!1},"undefined"!=typeof e?e.sweetAlert=e.swal=d:f.logStr("SweetAlert is a frontend module!"),i.exports=o["default"]},{"./modules/default-params":2,"./modules/handle-click":3,"./modules/handle-dom":4,"./modules/handle-key":5,"./modules/handle-swal-dom":6,"./modules/set-params":8,"./modules/utils":9}],2:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var a={title:"",text:"",type:null,allowOutsideClick:!1,showConfirmButton:!0,showCancelButton:!1,closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"OK",confirmButtonColor:"#8CD4F5",cancelButtonText:"Cancel",imageUrl:null,imageSize:null,timer:null,customClass:"",html:!1,animation:!0,allowEscapeKey:!0,inputType:"text",inputPlaceholder:"",inputValue:"",showLoaderOnConfirm:!1};n["default"]=a,t.exports=n["default"]},{}],3:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0});var i=t("./utils"),o=(t("./handle-swal-dom"),t("./handle-dom")),r=function(t,n,a){function r(e){p&&n.confirmButtonColor&&(m.style.backgroundColor=e)}var d,c,u,f=t||e.event,m=f.target||f.srcElement,p=-1!==m.className.indexOf("confirm"),_=-1!==m.className.indexOf("sweet-overlay"),g=o.hasClass(a,"visible"),h=n.doneFunction&&"true"===a.getAttribute("data-has-done-function");switch(p&&n.confirmButtonColor&&(d=n.confirmButtonColor,c=i.colorLuminance(d,-.04),u=i.colorLuminance(d,-.14)),f.type){case"mouseover":r(c);break;case"mouseout":r(d);break;case"mousedown":r(u);break;case"mouseup":r(c);break;case"focus":var v=a.querySelector("button.confirm"),x=a.querySelector("button.cancel");p?x.style.boxShadow="none":v.style.boxShadow="none";break;case"click":var w=a===m,y=o.isDescendant(a,m);if(!w&&!y&&g&&!n.allowOutsideClick)break;p&&h&&g?s(a,n):h&&g||_?l(a,n):o.isDescendant(a,m)&&"BUTTON"===m.tagName&&sweetAlert.close()}},s=function(e,t){var n=!0;o.hasClass(e,"show-input")&&(n=e.querySelector("input").value,n||(n="")),t.doneFunction(n),t.closeOnConfirm&&sweetAlert.close(),t.showLoaderOnConfirm&&sweetAlert.disableButtons()},l=function(e,t){var n=String(t.doneFunction).replace(/\s/g,""),a="function("===n.substring(0,9)&&")"!==n.substring(9,10);a&&t.doneFunction(!1),t.closeOnCancel&&sweetAlert.close()};a["default"]={handleButton:r,handleConfirm:s,handleCancel:l},n.exports=a["default"]},{"./handle-dom":4,"./handle-swal-dom":6,"./utils":9}],4:[function(n,a,i){Object.defineProperty(i,"__esModule",{value:!0});var o=function(e,t){return new RegExp(" "+t+" ").test(" "+e.className+" ")},r=function(e,t){o(e,t)||(e.className+=" "+t)},s=function(e,t){var n=" "+e.className.replace(/[\t\r\n]/g," ")+" ";if(o(e,t)){for(;n.indexOf(" "+t+" ")>=0;)n=n.replace(" "+t+" "," ");e.className=n.replace(/^\s+|\s+$/g,"")}},l=function(e){var n=t.createElement("div");return n.appendChild(t.createTextNode(e)),n.innerHTML},d=function(e){e.style.opacity="",e.style.display="block"},c=function(e){if(e&&!e.length)return d(e);for(var t=0;t<e.length;++t)d(e[t])},u=function(e){e.style.opacity="",e.style.display="none"},f=function(e){if(e&&!e.length)return u(e);for(var t=0;t<e.length;++t)u(e[t])},m=function(e,t){for(var n=t.parentNode;null!==n;){if(n===e)return!0;n=n.parentNode}return!1},p=function(e){e.style.left="-9999px",e.style.display="block";var t,n=e.clientHeight;return t="undefined"!=typeof getComputedStyle?parseInt(getComputedStyle(e).getPropertyValue("padding-top"),10):parseInt(e.currentStyle.padding),e.style.left="",e.style.display="none","-"+parseInt((n+t)/2)+"px"},_=function(e,t){if(+e.style.opacity<1){t=t||16,e.style.opacity=0,e.style.display="block";var n=+new Date,a=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){e.style.opacity=+e.style.opacity+(new Date-n)/100,n=+new Date,+e.style.opacity<1&&setTimeout(a,t)});a()}e.style.display="block"},g=function(e,t){t=t||16,e.style.opacity=1;var n=+new Date,a=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){e.style.opacity=+e.style.opacity-(new Date-n)/100,n=+new Date,+e.style.opacity>0?setTimeout(a,t):e.style.display="none"});a()},h=function(n){if("function"==typeof MouseEvent){var a=new MouseEvent("click",{view:e,bubbles:!1,cancelable:!0});n.dispatchEvent(a)}else if(t.createEvent){var i=t.createEvent("MouseEvents");i.initEvent("click",!1,!1),n.dispatchEvent(i)}else t.createEventObject?n.fireEvent("onclick"):"function"==typeof n.onclick&&n.onclick()},v=function(t){"function"==typeof t.stopPropagation?(t.stopPropagation(),t.preventDefault()):e.event&&e.event.hasOwnProperty("cancelBubble")&&(e.event.cancelBubble=!0)};i.hasClass=o,i.addClass=r,i.removeClass=s,i.escapeHtml=l,i._show=d,i.show=c,i._hide=u,i.hide=f,i.isDescendant=m,i.getTopMargin=p,i.fadeIn=_,i.fadeOut=g,i.fireClick=h,i.stopEventPropagation=v},{}],5:[function(t,a,i){Object.defineProperty(i,"__esModule",{value:!0});var o=t("./handle-dom"),r=t("./handle-swal-dom"),s=function(t,a,i){var s=t||e.event,l=s.keyCode||s.which,d=i.querySelector("button.confirm"),c=i.querySelector("button.cancel"),u=i.querySelectorAll("button[tabindex]");if(-1!==[9,13,32,27].indexOf(l)){for(var f=s.target||s.srcElement,m=-1,p=0;p<u.length;p++)if(f===u[p]){m=p;break}9===l?(f=-1===m?d:m===u.length-1?u[0]:u[m+1],o.stopEventPropagation(s),f.focus(),a.confirmButtonColor&&r.setFocusStyle(f,a.confirmButtonColor)):13===l?("INPUT"===f.tagName&&(f=d,d.focus()),f=-1===m?d:n):27===l&&a.allowEscapeKey===!0?(f=c,o.fireClick(f,s)):f=n}};i["default"]=s,a.exports=i["default"]},{"./handle-dom":4,"./handle-swal-dom":6}],6:[function(n,a,i){var o=function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(i,"__esModule",{value:!0});var r=n("./utils"),s=n("./handle-dom"),l=n("./default-params"),d=o(l),c=n("./injected-html"),u=o(c),f=".sweet-alert",m=".sweet-overlay",p=function(){var e=t.createElement("div");for(e.innerHTML=u["default"];e.firstChild;)t.body.appendChild(e.firstChild)},_=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=t.querySelector(f);return e||(p(),e=_()),e}),g=function(){var e=_();return e?e.querySelector("input"):void 0},h=function(){return t.querySelector(m)},v=function(e,t){var n=r.hexToRgb(t);e.style.boxShadow="0 0 2px rgba("+n+", 0.8), inset 0 0 0 1px rgba(0, 0, 0, 0.05)"},x=function(n){var a=_();s.fadeIn(h(),10),s.show(a),s.addClass(a,"showSweetAlert"),s.removeClass(a,"hideSweetAlert"),e.previousActiveElement=t.activeElement;var i=a.querySelector("button.confirm");i.focus(),setTimeout(function(){s.addClass(a,"visible")},500);var o=a.getAttribute("data-timer");if("null"!==o&&""!==o){var r=n;a.timeout=setTimeout(function(){var e=(r||null)&&"true"===a.getAttribute("data-has-done-function");e?r(null):sweetAlert.close()},o)}},w=function(){var e=_(),t=g();s.removeClass(e,"show-input"),t.value=d["default"].inputValue,t.setAttribute("type",d["default"].inputType),t.setAttribute("placeholder",d["default"].inputPlaceholder),y()},y=function(e){if(e&&13===e.keyCode)return!1;var t=_(),n=t.querySelector(".sa-input-error");s.removeClass(n,"show");var a=t.querySelector(".sa-error-container");s.removeClass(a,"show")},b=function(){var e=_();e.style.marginTop=s.getTopMargin(_())};i.sweetAlertInitialize=p,i.getModal=_,i.getOverlay=h,i.getInput=g,i.setFocusStyle=v,i.openModal=x,i.resetInput=w,i.resetInputError=y,i.fixVerticalPosition=b},{"./default-params":2,"./handle-dom":4,"./injected-html":7,"./utils":9}],7:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var a='<div class="sweet-overlay" tabIndex="-1"></div><div class="sweet-alert"><div class="sa-icon sa-error">\n      <span class="sa-x-mark">\n        <span class="sa-line sa-left"></span>\n        <span class="sa-line sa-right"></span>\n      </span>\n    </div><div class="sa-icon sa-warning">\n      <span class="sa-body"></span>\n      <span class="sa-dot"></span>\n    </div><div class="sa-icon sa-info"></div><div class="sa-icon sa-success">\n      <span class="sa-line sa-tip"></span>\n      <span class="sa-line sa-long"></span>\n\n      <div class="sa-placeholder"></div>\n      <div class="sa-fix"></div>\n    </div><div class="sa-icon sa-custom"></div><h2>Title</h2>\n    <p>Text</p>\n    <fieldset>\n      <input type="text" tabIndex="3" />\n      <div class="sa-input-error"></div>\n    </fieldset><div class="sa-error-container">\n      <div class="icon">!</div>\n      <p>Not valid!</p>\n    </div><div class="sa-button-container">\n      <button class="cancel" tabIndex="2">Cancel</button>\n      <div class="sa-confirm-button-container">\n        <button class="confirm" tabIndex="1">OK</button><div class="la-ball-fall">\n          <div></div>\n          <div></div>\n          <div></div>\n        </div>\n      </div>\n    </div></div>';n["default"]=a,t.exports=n["default"]},{}],8:[function(e,t,a){Object.defineProperty(a,"__esModule",{value:!0});var i=e("./utils"),o=e("./handle-swal-dom"),r=e("./handle-dom"),s=["error","warning","info","success","input","prompt"],l=function(e){var t=o.getModal(),a=t.querySelector("h2"),l=t.querySelector("p"),d=t.querySelector("button.cancel"),c=t.querySelector("button.confirm");if(a.innerHTML=e.html?e.title:r.escapeHtml(e.title).split("\n").join("<br>"),l.innerHTML=e.html?e.text:r.escapeHtml(e.text||"").split("\n").join("<br>"),e.text&&r.show(l),e.customClass)r.addClass(t,e.customClass),t.setAttribute("data-custom-class",e.customClass);else{var u=t.getAttribute("data-custom-class");r.removeClass(t,u),t.setAttribute("data-custom-class","")}if(r.hide(t.querySelectorAll(".sa-icon")),e.type&&!i.isIE8()){var f=function(){for(var a=!1,i=0;i<s.length;i++)if(e.type===s[i]){a=!0;break}if(!a)return logStr("Unknown alert type: "+e.type),{v:!1};var l=["success","error","warning","info"],d=n;-1!==l.indexOf(e.type)&&(d=t.querySelector(".sa-icon.sa-"+e.type),r.show(d));var c=o.getInput();switch(e.type){case"success":r.addClass(d,"animate"),r.addClass(d.querySelector(".sa-tip"),"animateSuccessTip"),r.addClass(d.querySelector(".sa-long"),"animateSuccessLong");break;case"error":r.addClass(d,"animateErrorIcon"),r.addClass(d.querySelector(".sa-x-mark"),"animateXMark");break;case"warning":r.addClass(d,"pulseWarning"),r.addClass(d.querySelector(".sa-body"),"pulseWarningIns"),r.addClass(d.querySelector(".sa-dot"),"pulseWarningIns");break;case"input":case"prompt":c.setAttribute("type",e.inputType),c.value=e.inputValue,c.setAttribute("placeholder",e.inputPlaceholder),r.addClass(t,"show-input"),setTimeout(function(){c.focus(),c.addEventListener("keyup",swal.resetInputError)},400)}}();if("object"==typeof f)return f.v}if(e.imageUrl){var m=t.querySelector(".sa-icon.sa-custom");m.style.backgroundImage="url("+e.imageUrl+")",r.show(m);var p=80,_=80;if(e.imageSize){var g=e.imageSize.toString().split("x"),h=g[0],v=g[1];h&&v?(p=h,_=v):logStr("Parameter imageSize expects value with format WIDTHxHEIGHT, got "+e.imageSize)}m.setAttribute("style",m.getAttribute("style")+"width:"+p+"px; height:"+_+"px")}t.setAttribute("data-has-cancel-button",e.showCancelButton),e.showCancelButton?d.style.display="inline-block":r.hide(d),t.setAttribute("data-has-confirm-button",e.showConfirmButton),e.showConfirmButton?c.style.display="inline-block":r.hide(c),e.cancelButtonText&&(d.innerHTML=r.escapeHtml(e.cancelButtonText)),e.confirmButtonText&&(c.innerHTML=r.escapeHtml(e.confirmButtonText)),e.confirmButtonColor&&(c.style.backgroundColor=e.confirmButtonColor,c.style.borderLeftColor=e.confirmLoadingButtonColor,c.style.borderRightColor=e.confirmLoadingButtonColor,o.setFocusStyle(c,e.confirmButtonColor)),t.setAttribute("data-allow-outside-click",e.allowOutsideClick);var x=e.doneFunction?!0:!1;t.setAttribute("data-has-done-function",x),e.animation?"string"==typeof e.animation?t.setAttribute("data-animation",e.animation):t.setAttribute("data-animation","pop"):t.setAttribute("data-animation","none"),t.setAttribute("data-timer",e.timer)};a["default"]=l,t.exports=a["default"]},{"./handle-dom":4,"./handle-swal-dom":6,"./utils":9}],9:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0});var i=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},o=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?parseInt(t[1],16)+", "+parseInt(t[2],16)+", "+parseInt(t[3],16):null},r=function(){return e.attachEvent&&!e.addEventListener},s=function(t){e.console&&e.console.log("SweetAlert: "+t)},l=function(e,t){e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;var n,a,i="#";for(a=0;3>a;a++)n=parseInt(e.substr(2*a,2),16),n=Math.round(Math.min(Math.max(0,n+n*t),255)).toString(16),i+=("00"+n).substr(n.length);return i};a.extend=i,a.hexToRgb=o,a.isIE8=r,a.logStr=s,a.colorLuminance=l},{}]},{},[1]),"function"==typeof define&&define.amd?define("swal",[],function(){return sweetAlert}):"undefined"!=typeof module&&module.exports&&(module.exports=sweetAlert)}(window,document),define("viewmode/create_svg",[],function(){return function(e){if(e){var t=d3.select(e).insert("svg",".buttons");t.attr({id:"svgbox"}),t.append("defs").append("marker").attr({id:"end",viewBox:"0 -5 10 10",refX:25,refY:-1,markerWidth:6,markerHeight:6,orient:"auto"}).append("path").attr("d","M0,-5L10,0L0,5")}else t="";return t}}),define("viewmode/tick_helper",[],function(){return function(e,t,n,a){function i(e){var t=s(e.source.x),n=l(e.source.y),a=s(e.target.x),i=l(e.target.y),o=a-t,r=i-n,d=Math.sqrt(o*o+r*r);if(e.target===e.source){var c=50,u="50",f="33";return"M"+t+","+n+" A"+u+","+f+" 0 0,1 "+(a+c)+","+(i+c)+" M"+(a+c)+","+(i+c)+" A"+f+","+u+" 0 0,1 "+t+","+n}return"M"+t+","+n+" A"+d+","+d+" 0 0,1 "+a+","+i}function o(e){var t=s(e.x),n=l(e.y);return e.graphicEditor.coordX=t,e.graphicEditor.coordY=n,"translate("+t+","+n+")"}function r(e){var t=s(e.source.x),n=l(e.source.y),a=s(e.target.x),i=l(e.target.y),o="";return o+=e.source==e.target?"translate("+(t+50)+","+(n+50)+")":"translate("+(t+a)/2+","+(n+i)/2+")"}function s(e){return Math.max(t,Math.min(e,n-t))}function l(e){return Math.max(t,Math.min(e,a-t))}var d=d3.selectAll(".link"),c=d3.selectAll(".condition"),u=d3.selectAll("circle"),f=d3.selectAll(".state_name");d.attr("d",i),c.attr("transform",r),u.attr("transform",o),f.attr("transform",o)}}),define("viewmode/create_force_layout",["require","viewmode/tick_helper"],function(e){return function(t,n,a){var i=e("viewmode/tick_helper"),o=$("#svgbox")[0].getBoundingClientRect().width,r=$("#svgbox")[0].getBoundingClientRect().height,s=d3.layout.force().nodes(d3.values(n)).links(d3.values(a)).size(function(){t.each(function(){return[this.clientWidth,this.clientHeight]})}).linkDistance(200).charge(-200).on("tick",function(e){var t=15;i(e,t,o,r)}).start();return s}}),define("viewmode/create_circles",[],function(){return function(e,t){var n=e;n.append("g").classed("state_container",!0).selectAll("circle").data(t.nodes()).enter().append("circle").attr({r:"15","class":function(e){return e.terminal?"terminal":""},id:function(e){return"state_"+e.index},fill:function(e){return e.fill}}).call(t.drag)}}),define("viewmode/create_state_names",[],function(){return function(e,t){var n=e,a=n.append("g").classed("name_container",!0).selectAll("text").data(t.nodes()).enter().append("text").attr({x:20,y:0,"class":"state_name",id:function(e){return"state_name_"+e.index}});a.append("tspan").text(function(e){return e.name}).classed("state_name_label",!0),a.append("tspan").text(function(e){return e.max_noise>0?"["+e.max_noise+"]":""}).attr("dx",3).classed("state_name_maxnoise",!0)}}),define("viewmode/create_paths",[],function(){return function(e,t){var n=e;n.append("g").classed("path_container",!0).selectAll("path").data(t.links()).enter().append("path").attr({"class":"link",id:function(e){return"link_"+e.source.index+"_"+e.target.index},"marker-end":"url(#end)"})}}),define("viewmode/condition_list",[],function(){return function(e){var t="",n=!1;return e.conditions&&e.conditions.forEach(function(e){n?t+=", "+e.condition:(n=!0,t+=e.condition)}),t}}),define("viewmode/create_conditions",["require","viewmode/condition_list"],function(e){return function(t,n){var a=e("viewmode/condition_list"),i=t;i.append("g").classed("condition_container",!0).selectAll("text").data(n.links()).enter().append("text").attr({x:20,y:0,"class":function(e){return"condition link_"+e.source.index+"_"+e.target.index}}).text(a)}}),define("utility/undo",[],function(){function e(){return l.length===o}function t(){return 0===l.length}function n(t){if(r){var n=_.cloneDeep(l[l.length-(1+s)]);l=[n],r=!1,s=0}var a=_.cloneDeep(t);e(l)&&l.shift(),l.push(a)}function a(){return r||(r=!0),s>=l.length-1?s=l.length-1:s++,_.cloneDeep(l[l.length-(1+s)])}function i(){return r?(0>=s?s=0:s--,_.cloneDeep(l[l.length-(1+s)])):!0}var o=50,r=!1,s=0,l=[];return{addToStack:n,rollBack:a,rollForth:i,stackEmpty:t}}),define("viewmode/view_init",["require","viewmode/create_svg","viewmode/create_force_layout","viewmode/create_circles","viewmode/create_state_names","viewmode/create_paths","viewmode/create_conditions","viewmode/view_init","utility/undo"],function(e){return{extractStates:function(e){var t=[];if(e)for(var n=0;n<e.length;n++)e[n].states&&t.push(e[n].states);return t},getIdFromName:function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&e[n]&&t===e[n].name)return e[n].uniqueId},getConditions:function(e,t,n){var a=[];for(var i in e)e.hasOwnProperty(i)&&e[i]&&e[i].uniqueId===t&&e[i].transitions&&e[i].transitions.forEach(function(e){e.target===n&&a.push(e)});return a},init:function(t,n){var a=e("viewmode/create_svg"),i=e("viewmode/create_force_layout"),o=e("viewmode/create_circles"),r=e("viewmode/create_state_names"),s=e("viewmode/create_paths"),l=e("viewmode/create_conditions"),d=e("viewmode/view_init"),c=e("utility/undo");if(t){var u,f,m=[],p=[],_={},g=!1,h=0,v=0;t.forEach(function(e){v=0;for(u in e)e.hasOwnProperty(u)&&(f=e[u],f&&(f.fixed=!0,f.uniqueId=v,f.index=v,f.name=u,f.graphicEditor?(f.graphicEditor.origCoordX=f.graphicEditor.coordX,f.graphicEditor.origCoordY=f.graphicEditor.coordY):f.graphicEditor={},f.x=f.graphicEditor.coordX||0,f.y=f.graphicEditor.coordY||0,p.push(f),v++));for(u in e)if(e.hasOwnProperty(u)&&(f=e[u],f&&f.transitions&&f.transitions.length>0))for(h=0;h<f.transitions.length;h++)g=m.find(function(e){return e.source===f.uniqueId&&e.target===d.getIdFromName(p,f.transitions[h].target)}),g||(_={source:f.uniqueId,target:d.getIdFromName(p,f.transitions[h].target),conditions:d.getConditions(p,f.uniqueId,f.transitions[h].target)},m.push(_))}),$("svg").size()>0&&$("svg").remove();var x=a("#svg_container"),w=i(x,p,m);s(x,w),l(x,w),o(x,w),r(x,w)}return w.drag().on("dragend",function(){c.addToStack(n)}),d3.select(document).on("keyup",function(){if(d3.event.ctrlKey)switch(d3.event.keyCode){case 90:var e=c.rollBack();e&&d.init(d.extractStates([e]),e,!0);break;case 89:var t=c.rollForth();t&&d.init(d.extractStates([t]),t,!0)}}),{svg:x,force:w,getData:n,links:m}}}}),define("viewmode/data_helper",[],function(){return{cleanData:function(e){var t,n,a={states:{}};e.allow_overlap&&(a.allow_overlap=e.allow_overlap),e.state_defaults&&(a.state_defaults=e.state_defaults),e.default_matcher&&(a.default_matcher=e.default_matcher);for(t in e.states)if(e.states.hasOwnProperty(t)&&e.states[t]){a.states[t]={};for(n in e.states[t])e.states[t].hasOwnProperty(n)&&("default_transition"===n||"graphicEditor"===n||"max_duration"===n||"max_noise"===n||"max_total_duration"===n||"max_total_noise"===n||"terminal"===n||"transitions"===n)&&(a.states[t][n]=e.states[t][n])}return a}}}),define("menu/context_menu",[],function(){return function(e){return""}}),define("editmode/cancel_all_selections",[],function(){return function(){d3.selectAll("circle").each(function(e){e.graphicEditor.linking&&(e.graphicEditor.linking=!1,d3.select("#state_"+e.index).classed("linking",!1))})}}),define("utility/utility",[],function(){return{displayObject:function(e,t){var n,a,i,o="",r=20,s=0;t++;for(var l=0;l<e.length;l++){o+='<span style="padding-left:'+r+'px;"></span>{<br/>';for(n in e[l])if(e[l].hasOwnProperty(n)){var d=e[l][n];if("graphicEditor"!=n){if(o+='<span style="padding-left:'+(r*t+r)+'px;"></span>',"string"==typeof d)o+=n+" : '"+d+"'";else if("[object Object]"==Object.prototype.toString.call(d))o+=n+" : "+this.displayObject([d],t);else if("[object Array]"==Object.prototype.toString.call(d)){for(o+=n+' : [<br/><span style="padding-left:'+r*(t+2)+'px;"></span>',s=0;s<d.length;s++)a=d[s],i=Object.prototype.toString.call(a),o+="[object Object]"==i||"[object Array]"==i?s==d.length-1?this.displayObject([a],t+2):this.displayObject([a],t+2)+',<br/><span style="padding-left:'+r*(t+2)+'px;"></span>':"string"==i?s==d.length-1?"'"+a+"'":"'"+a+"',<br/><span style=\"padding-left:"+r*(t+2)+'px;"></span>':s==d.length-1?a:a+',<br/><span style="padding-left:'+r*(t+2)+'px;"></span>';o+='<br/><span style="padding-left:'+(r*t+r)+'px;"></span>]'}else o+=n+" : "+d;o+=",<br/>"}}","==o.charAt(o.length-6)&&(o=o.slice(0,-6)+o.slice(-5)),"<br/>"==o.slice(-5)&&(o=o.slice(0,-5)),o+='<br/><span style="padding-left:'+r*t+'px;"></span> }',l!=e.length-1&&(o+="<br/>")}return o},frontEndObject:function(e){var t="#object_container_left";$(t).html("{<br/>"+this.displayObject(e,0)+"<br/>}"),$(t).parents().find("textarea#objectArea").size()>0&&$(t).parents().find("textarea#objectArea").val(function(){for(var t="",n=0;n<e.length;n++)t+=JSON.stringify(e[n]);return t})}}}),define("editmode/edit_frontend_object",["require","utility/utility","viewmode/data_helper"],function(e){return function(t){var n=e("utility/utility"),a=e("viewmode/data_helper"),i=a.cleanData(t);n.frontEndObject([i])}}),define("editmode/global/edit_global",[],function(){return function(e,t){t.getData.allow_overlap=e.newOverlap,t.getData.default_matcher=e.newDefaultMatcher,t.getData.state_defaults?(t.getData.state_defaults.terminal=e.newTerminal,t.getData.state_defaults.max_noise=parseInt(e.newMaxNoise)||0,t.getData.state_defaults.max_total_noise=parseInt(e.newMaxTotalNoise)||0,t.getData.state_defaults.max_duration=parseInt(e.newMaxDuration)||0,t.getData.state_defaults.max_total_duration=parseInt(e.newMaxTotalDuration)||0):t.getData.state_defaults={terminal:e.newTerminal,max_noise:e.newMaxNoise,max_total_noise:e.newMaxTotalNoise,max_duration:e.newMaxDuration,max_total_duration:e.newMaxTotalDuration}}}),define("editmode/global/get_global_edition",["require","editmode/global/edit_global","utility/undo","editmode/edit_frontend_object"],function(e){return function(t){function n(){for(var e,n="",a="",i=[{name:"allow_overlap",type:"check"},{name:"default_matcher",type:"text"},{name:"state_defaults",type:""},{name:"terminal",type:"check",sub:"state_defaults"},{name:"max_noise",type:"number",sub:"state_defaults"},{name:"max_total_noise",type:"number",sub:"state_defaults"},{name:"max_duration",type:"number",sub:"state_defaults"},{name:"max_total_duration",type:"number",sub:"state_defaults"}],o=0;o<i.length;o++){switch(e=i[o].sub?t.getData[i[o].sub][i[o].name]:t.getData[i[o].name],i[o].type){case"text":a="<input class='custom_swal_input' type='text' value='"+(e||"")+"' id='input_"+i[o].name+"' />";break;case"number":a="<input class='custom_swal_input' type='number' value='"+(e||0)+"' id='input_"+i[o].name+"' />";break;case"check":a="<input class='custom_swal_input' type='checkbox' "+(e?"checked='true' ":"")+"id='input_"+i[o].name+"' />";break;default:a=""}n+="<span class='swal_display global_display'><label class='custom_swal_label' for='input_"+i[o].name+"' id='label_property_"+i[o].name+"'>"+i[o].name+" : </label>"+a+"</span>"}return n}var a=e("editmode/global/edit_global"),i=e("utility/undo"),o=e("editmode/edit_frontend_object");swal({title:"Edit global properties",text:n(),html:!0,showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top"},function(e){if(e){var n,r=!1,s="",l=!1,d=0,c=0,u=0,f=0;if(r=d3.select("#input_allow_overlap").property("checked"),s=d3.select("#input_default_matcher").property("value"),l=d3.select("#input_terminal").property("checked"),d=parseInt(d3.select("#input_max_noise").property("value")),c=parseInt(d3.select("#input_max_total_noise").property("value")),u=parseInt(d3.select("#input_max_duration").property("value")),f=parseInt(d3.select("#input_max_total_duration").property("value")),0>d)return swal.showInputError("max_noise cannot be negative"),!1;if(d>c)return swal.showInputError("max_noise cannot be > total_max_noise"),!1;if(0>c)return swal.showInputError("max_total_noise cannot be negative"),!1;if(0>u)return swal.showInputError("max_duration cannot be negative"),!1;if(u>f)return swal.showInputError("max_duration cannot be > total_max_duration"),!1;if(0>f)return swal.showInputError("max_total_duration cannot be negative"),!1;n={newOverlap:r,newDefaultMatcher:s,newTerminal:l,newMaxNoise:d,newMaxTotalNoise:c,newMaxDuration:u,newMaxTotalDuration:f},a(n,t),o(t.getData),i.addToStack(t.getData),swal.close()}else{if(e===!1)return!1;if(""===e)return swal.showInputError("error"),!1}})}}),define("editmode/state/delete_state",[],function(){return function(e,t){var n,a,i=t.getData.states,o=[],r=[],s=0,l=0;for(t.force.links().forEach(function(t,n){(t.source.index==e||t.target.index==e)&&o.push(n)}),s=0;s<o.length;s++)for(t.force.links().splice(o[s],1),l=0;l<o.length;l++)o[l]--;for(t.force.nodes().forEach(function(t,n){t.index==e&&(r.push(n),d3.select("#state_"+e).remove())}),s=0;s<r.length;s++)for(t.force.nodes().splice(r[s],1),l=0;l<r.length;l++)r[l]--;d3.select("#state_name_"+e).remove(),d3.selectAll("path.link").each(function(t){n=t.source.index,a=t.target.index,(n==e||a==e)&&(d3.selectAll("path.link[id$='_"+e+"'],path.link[id^='link_"+e+"_']").remove(),d3.selectAll("text.condition[class$='_"+e+"'],text.condition[class*='link_"+e+"_']").remove())});for(var d in i)i.hasOwnProperty(d)&&i[d]&&i[d].index==e&&(i[d]=void 0);t.force.start(),d3.selectAll("circle").attr("id",function(e){return"state_"+e.index}),d3.selectAll("text.state_name").attr("id",function(e){return"state_name_"+e.index}),d3.selectAll("path.link").attr("id",function(e){return"link_"+e.source.index+"_"+e.target.index}),d3.selectAll("text.condition").attr("class",function(e){return"condition link_"+e.source.index+"_"+e.target.index})}}),define("editmode/state/delete_references",[],function(){return function(e,t){var n=e.states,a=[],i=0,o=0;for(var r in n)if(n.hasOwnProperty(r)&&n[r]&&n[r].transitions)for(a=[],n[r].transitions.forEach(function(e,n){e.target==t&&a.push(n)}),i=0;i<a.length;i++)for(n[r].transitions.splice(a[i],1),o=0;o<a.length;o++)a[o]--}}),define("editmode/state/edit_references",[],function(){return function(e,t,n){var a=e.states;for(var i in a)a.hasOwnProperty(i)&&a[i]&&a[i].transitions&&a[i].transitions.forEach(function(e){e.target==t&&(e.target=n)})}}),define("editmode/state/edit_state_defaulttransition",[],function(){return function(e,t,n,a){var i,o=a.getData.states,r="";if(e.max_noise>0){e.default_transition=void 0;for(i in o)o.hasOwnProperty(i)&&o[i]&&o[i].index===e.index&&(o[i].default_transition=void 0)}else{for(i in o)o.hasOwnProperty(i)&&o[i]&&parseInt(o[i].index)===parseInt(n)&&(r=o[i].name);e.default_transition?(e.default_transition.silent=t,e.default_transition.target=r):e.default_transition={silent:t,target:r};for(i in o)o.hasOwnProperty(i)&&o[i]&&o[i].index===e.index&&(o[i].default_transition?(o[i].default_transition.silent=t,o[i].default_transition.target=r):o[i].default_transition={silent:t,target:r})}}}),define("editmode/state/edit_state_maxduration",[],function(){return function(e,t,n){e.max_duration=t,n.getData.states[e.name]&&(n.getData.states[e.name].max_duration=parseInt(t)||0)}}),define("editmode/state/edit_state_maxtotalduration",[],function(){return function(e,t,n){e.max_total_duration=t,n.getData.states[e.name]&&(n.getData.states[e.name].max_total_duration=parseInt(t)||0)}}),define("editmode/state/edit_state_maxnoise",[],function(){return function(e,t,n){e.max_noise=t,n.getData.states[e.name].max_noise=parseInt(t)||0,
d3.select("text#state_name_"+e.index+" tspan.state_name_maxnoise").html(function(e){return e.max_noise>0?"["+e.max_noise+"]":""}),n.force.start()}}),define("editmode/state/edit_state_maxtotalnoise",[],function(){return function(e,t,n){e.max_total_noise=t,n.getData.states[e.name]&&(n.getData.states[e.name].max_total_noise=parseInt(t)||0)}}),define("editmode/state/edit_state_name",[],function(){return function(e,t,n){var a=e.name;e.name=t,n.getData.states[e.name]=n.getData.states[a],n.getData.states[a]=void 0,d3.select("text#state_name_"+e.index+" tspan.state_name_label").html(function(e){return e.name}),n.force.start()}}),define("editmode/state/edit_state_terminal",[],function(){return function(e,t,n){e.terminal=t,n.getData.states[e.name].terminal=t,d3.select("circle#state_"+e.index).classed("terminal",function(){return e.terminal})}}),define("editmode/state/edit_state",["require","editmode/state/edit_references","editmode/state/edit_state_defaulttransition","editmode/state/edit_state_maxduration","editmode/state/edit_state_maxtotalduration","editmode/state/edit_state_maxnoise","editmode/state/edit_state_maxtotalnoise","editmode/state/edit_state_name","editmode/state/edit_state_terminal"],function(e){return function(t,n,a){var i=e("editmode/state/edit_references"),o=e("editmode/state/edit_state_defaulttransition"),r=e("editmode/state/edit_state_maxduration"),s=e("editmode/state/edit_state_maxtotalduration"),l=e("editmode/state/edit_state_maxnoise"),d=e("editmode/state/edit_state_maxtotalnoise"),c=e("editmode/state/edit_state_name"),u=e("editmode/state/edit_state_terminal");t.newMaxDuration!==n.max_duration&&r(n,t.newMaxDuration,a),t.newMaxNoise!==n.max_noise&&l(n,t.newMaxNoise,a),t.newMaxTotalDuration!==n.max_total_duration&&s(n,t.newMaxTotalDuration,a),t.newMaxTotalNoise!==n.max_total_noise&&d(n,t.newMaxTotalNoise,a),t.newName!==n.name&&(i(a.getData,n.name,t.newName),c(n,t.newName,a)),t.newTerminal!==n.terminal&&u(n,t.newTerminal,a),t.newDefaultTransition&&(n.default_transition?(t.newDefaultTransition.silent!==n.default_transition.silent||t.newDefaultTransition.target!==n.default_transition.target)&&o(n,t.newDefaultTransition.silent,t.newDefaultTransition.target,a):o(n,t.newDefaultTransition.silent,t.newDefaultTransition.target,a)),a.force.start()}}),define("editmode/cancel_selection",[],function(){return function(e){e&&(d3.select("#state_"+e.index).classed("editing",!1),e.graphicEditor.linking=!1,d3.select("#state_"+e.index).classed("linking",!1))}}),define("editmode/state/get_state_edition",["require","editmode/state/edit_state","editmode/cancel_selection","utility/undo","editmode/edit_frontend_object"],function(e){return function(t,n){function a(e){for(var t,a="",i=n.getData.states[e.name],o="",r=[{name:"name",type:"text"},{name:"terminal",type:"check"},{name:"max_noise",type:"number"},{name:"max_total_noise",type:"number"},{name:"max_duration",type:"number"},{name:"max_total_duration",type:"number"},{name:"default_transition",type:"transition"}],s="",l=!1,d=!1,c=0;c<r.length;c++){switch(r[c].type){case"text":o="<input class='custom_swal_input' type='text' value='"+(i[r[c].name]||"")+"' id='input_"+r[c].name+"_"+e.index+"' />";break;case"number":o="<input class='custom_swal_input' type='number' value='"+(i[r[c].name]||0)+"' id='input_"+r[c].name+"_"+e.index+"' />";break;case"check":o="<input class='custom_swal_input' type='checkbox' "+(i[r[c].name]?"checked='true' ":"")+"id='input_"+r[c].name+"_"+e.index+"' />";break;case"transition":s="",l=!1;for(t in n.getData.states)n.getData.states.hasOwnProperty(t)&&void 0!==n.getData.states[t]&&(void 0!==i[r[c].name]&&i[r[c].name].target==n.getData.states[t].name&&(l=n.getData.states[t].index),s+="<option "+(l===n.getData.states[t].index?"selected='true'":"")+"value='"+n.getData.states[t].index+"'>"+t+"</option>");d=!1,d=i[r[c].name]?i[r[c].name].silent:!1,o="<span class='swal_select_container'><span class='swal_select_subcontainer'><select class='custom_swal_select' id='input_"+r[c].name+"_target_"+e.index+"' ><option "+(l?"":"selected='true'")+" value=''>Select a target</option>"+s+"</select></span><span class='swal_select_subcontainer'><span class='sub_label'>silent : </span><input class='custom_swal_input' type='checkbox' "+(d?"checked='true' ":"")+"id='input_"+r[c].name+"_silent_"+e.index+"' /></span></span>";break;default:o=""}a+="<span class='swal_display state_display state_display_"+e.index+"'><label class='custom_swal_label' for='input_"+r[c].name+"_"+e.index+"' id='label_property_"+r[c].name+"'>"+r[c].name+" : </label>"+o+"</span>"}return a}var i=e("editmode/state/edit_state"),o=e("editmode/cancel_selection"),r=e("utility/undo"),s=e("editmode/edit_frontend_object");swal({title:t.name,text:a(t),html:!0,showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top"},function(e){if(e){var a,l="",d=!1,c=0,u=0,f=0,m=0,p={condition:"",target:0};if(l=d3.select("#input_name_"+t.index).property("value"),d=d3.select("#input_terminal_"+t.index).property("checked"),c=parseInt(d3.select("#input_max_noise_"+t.index).property("value")),u=parseInt(d3.select("#input_max_total_noise_"+t.index).property("value")),f=parseInt(d3.select("#input_max_duration_"+t.index).property("value")),m=parseInt(d3.select("#input_max_total_duration_"+t.index).property("value")),p.silent=d3.select("#input_default_transition_silent_"+t.index).property("checked"),p.target=d3.select("#input_default_transition_target_"+t.index).property("value"),0>c)return swal.showInputError("max_noise cannot be negative"),!1;if(c>u)return swal.showInputError("max_noise cannot be > max_total_noise"),!1;if(0>u)return swal.showInputError("max_total_noise cannot be negative"),!1;if(0>f)return swal.showInputError("max_duration cannot be negative"),!1;if(f>m)return swal.showInputError("max_duration cannot be > max_total_duration"),!1;if(0>m)return swal.showInputError("max_total_duration cannot be negative"),!1;if(parseInt(d3.select("[id^=input_max_noise_]").property("value"))>0&&parseInt(d3.select("[id^=input_default_transition_target_]").property("selectedIndex"))>0)return swal.showInputError("max_noise cannot be set with default_transition"),!1;for(var _ in n.getData.states)if(n.getData.states.hasOwnProperty(_)&&n.getData.states[_]&&l===n.getData.states[_].name&&n.getData.states[_].index!==t.index)return swal.showInputError("A state with this name already exists"),!1;a={newName:l,newTerminal:d,newMaxNoise:c,newMaxTotalNoise:u,newMaxDuration:f,newMaxTotalDuration:m,newDefaultTransition:p},i(a,t,n),o(t),s(n.getData),r.addToStack(n.getData),swal.close()}else{if(e===!1)return o(t),!1;if(""===e)return swal.showInputError("error"),!1}})}}),define("editmode/state/get_state_name_edition",["require","editmode/state/edit_references","editmode/state/edit_state_name","editmode/cancel_selection","utility/undo","editmode/edit_frontend_object"],function(e){return function(t,n){var a=e("editmode/state/edit_references"),i=e("editmode/state/edit_state_name"),o=e("editmode/cancel_selection"),r=e("utility/undo"),s=e("editmode/edit_frontend_object");swal({title:"State Edition",text:"Write a new name",type:"input",inputValue:t.name,showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top"},function(e){if(e){if(e!==t.name){for(var l in n.getData.states)if(n.getData.states.hasOwnProperty(l)&&n.getData.states[l]&&e===n.getData.states[l].name&&n.getData.states[l].index!==t.index)return swal.showInputError("A state with this name already exists"),!1;a(n.getData,t.name,e),i(t,e,n),o(t),s(n.getData),r.addToStack(n.getData)}swal.close()}else{if(e===!1)return o(t),!1;if(""===e)return swal.showInputError("Please enter a state name"),!1}})}}),define("editmode/state/get_max_noise_edition",["require","editmode/state/edit_state_maxnoise","editmode/cancel_selection","utility/undo","editmode/edit_frontend_object"],function(e){return function(t,n){var a=e("editmode/state/edit_state_maxnoise"),i=e("editmode/cancel_selection"),o=e("utility/undo"),r=e("editmode/edit_frontend_object");swal({title:"Max noise edition",text:"Write a new value",type:"input",inputType:"number",inputValue:t.max_noise,showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top"},function(e){if(e){if(parseInt(e)<0)return swal.showInputError("max_noise cannot be negative"),!1;if(parseInt(e)>parseInt(t.max_total_noise))return swal.showInputError("max_noise cannot be > max_total_noise ("+t.max_total_noise+")"),!1;a(t,e,n),i(t),r(n.getData),o.addToStack(n.getData),swal.close()}else{if(e===!1)return i(t),!1;if(""===e)return swal.showInputError("Please enter a value"),!1}})}}),define("editmode/transition/add_transition",[],function(){return function(e,t,n,a,i){var o=t.states[n.name],r={condition:i,target:a.name};o&&(o.transitions?o.transitions.push(r):o.transitions=[r]);var s=e.links().find(function(e){return e.source.index===n.index&&e.target.index===a.index});s?e.links().forEach(function(e){e.source.index===n.index&&e.target.index===a.index&&(e.conditions||(e.conditions=[]),e.conditions.push(r))}):e.links().push({conditions:[r],source:n,target:a}),e.start()}}),define("editmode/transition/edit_condition",["viewmode/condition_list"],function(){return function(e,t,n,a,i,o){var r=require("viewmode/condition_list");"new"===o?(e.select("g.path_container").selectAll("path").data(t.links()).enter().append("path").attr({"class":"link new_link",id:function(){return"link_"+n+"_"+a},"marker-end":"url(#end)"}),e.select("g.condition_container").selectAll("text").data(t.links()).enter().append("text").attr({x:20,y:0,"class":function(){return"condition link_"+n+"_"+a+" new_link"}}).text(r)):e.select(".condition.link_"+n+"_"+a).text(r).classed("new_condition",!0),t.start()}}),define("editmode/transition/edit_transition",["viewmode/condition_list"],function(){return function(e,t){var n=require("viewmode/condition_list");t.forEach(function(t){e.conditions&&e.conditions[t.index]&&(e.conditions[t.index].condition!==t.updatedValues.condition&&(e.conditions[t.index].condition=t.updatedValues.condition),e.conditions[t.index].matcher!==t.updatedValues.matcher&&(e.conditions[t.index].matcher=t.updatedValues.matcher),e.conditions[t.index].silent!==t.updatedValues.silent&&(e.conditions[t.index].silent=t.updatedValues.silent))}),d3.select("text.link_"+e.source.index+"_"+e.target.index).text(n)}}),define("editmode/transition/delete_transition",["viewmode/condition_list"],function(){return function(e,t,n){var a,i=require("viewmode/condition_list"),o=n.getData.states,r=[],s=0,l=0;for(var d in o)if(o.hasOwnProperty(d)&&o[d]&&o[d].index===e.source.index&&o[d].transitions)for(o[d].transitions.forEach(function(n,a){t.forEach(function(t){n.condition===e.conditions[t].condition&&n.target===e.target.name&&r.push(a)})}),s=0;s<r.length;s++)for(o[d].transitions.splice(r[s],1),l=0;l<r.length;l++)r[l]--;if(e.conditions)for(s=0;s<t.length;s++)for(e.conditions.splice(t[s],1),l=0;l<t.length;l++)t[l]--;d3.selectAll(".condition.link_"+e.source.index+"_"+e.target.index).text(i),e.conditions&&0===e.conditions.length&&(d3.selectAll(".link_"+e.source.index+"_"+e.target.index).remove(),d3.select("#link_"+e.source.index+"_"+e.target.index).remove(),n.force.links().forEach(function(t,n){t.source.index===e.source.index&&t.target.index===e.target.index&&(a=n)}),n.force.links().splice(a,1)),n.force.start()}}),define("editmode/transition/get_transition_edition",["require","editmode/transition/edit_transition","editmode/transition/delete_transition","utility/undo","editmode/edit_frontend_object"],function(e){return function(t,n){function a(e){var t="<div class='transition_title'>"+e.source.name+" => "+e.target.name+"</div>";return t+="<div class='header_transition'><span class='header_condition'>condition</span><span class='header_matcher'>matcher</span><span class='header_silent'>silent</span></div>",e.conditions&&e.conditions.forEach(function(e,n){t+="<span class='swal_display condition_display' id='condition_display_"+n+"'><span class='custom_swal_delete' id='delete_condition_"+n+"'>X</span><label><input class='custom_swal_input condition_input' type='text' value='"+e.condition+"' id='input_condition_"+n+"' /></label><label><input class='custom_swal_input matcher_input' type='text' value='"+(e.matcher?e.matcher:"")+"'/></label><label class='checkbox_label'><input class='custom_swal_input silent_input' type='checkbox' "+(e.silent?"checked='true'":"")+"'/></label> </span>"}),t}var i=e("editmode/transition/edit_transition"),o=e("editmode/transition/delete_transition"),r=e("utility/undo"),s=e("editmode/edit_frontend_object");swal({title:"Transition edition",text:a(t),html:!0,showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top"},function(e){if(e){var a=[],l=[],d={},c=!1,u=0,f=0,m="";if(d3.selectAll(".condition_display.user_delete").each(function(){u=0,f=0,u=this.getAttribute("id").indexOf("condition_display_")+"condition_display_".length,f=parseInt(this.getAttribute("id").substr(u,1)),a.push(f)}),d3.selectAll(".condition_display.user_edited").each(function(){u=0,f=0,u=this.getAttribute("id").indexOf("condition_display_")+"condition_display_".length,f=parseInt(this.getAttribute("id").substr(u,1)),d={index:f,updatedValues:{}},d3.select(this).selectAll("input").each(function(){switch(m=d3.select(this).attr("type")){case"text":d3.select(this).classed("condition_input")?d.updatedValues.condition=this.value:d3.select(this).classed("matcher_input")&&(d.updatedValues.matcher=this.value);break;case"checkbox":d3.select(this).classed("silent_input")&&(d.updatedValues.silent=this.checked)}}),d3.select(this.parentNode.parentNode).classed("user_delete")||l.push(d)}),l.length>0){if(l.forEach(function(e){e.updatedValues&&-1!=e.updatedValues.condition.indexOf(",")&&(c=!0)}),c)return swal.showInputError("',' is not allowed for transitions"),!1;i(t,l)}a.length>0&&o(t,a,n),s(n.getData),r.addToStack(n.getData),swal.close()}else{if(e===!1)return!1;if(""===e)return swal.showInputError("error"),!1}}),d3.selectAll(".custom_swal_delete").each(function(){d3.select(this).on("click",function(){d3.select(this.parentNode).classed("user_delete",!0)})}),d3.selectAll(".condition_display input").each(function(){d3.select(this).on("change",function(){d3.select(this.parentNode.parentNode).classed("user_edited",!0)})})}}),define("editmode/transition/get_condition",["require","editmode/transition/add_transition","editmode/transition/edit_condition","editmode/transition/get_transition_edition","utility/undo","editmode/edit_frontend_object"],function(e){return function(t,n,a,i){var o=e("editmode/transition/add_transition"),r=e("editmode/transition/edit_condition"),s=e("editmode/transition/get_transition_edition"),l=e("utility/undo"),d=e("editmode/edit_frontend_object"),c="#state_"+n.index,u=!1;swal({title:"Condition",text:"Write a condition for this new transition",type:"input",showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top",inputPlaceholder:"condition"},function(e){if(e===!1)return n.graphicEditor.linking=!1,t.graphicEditor.linking=!1,d3.select(c).classed("linking",!1),d3.select(a).classed("linking",!1),!1;if(""===e)return swal.showInputError("You need to write a condition"),!1;if(-1!==e.indexOf(","))return swal.showInputError("',' is not allowed for transitions"),!1;if(d3.select(c).data()[0].hasOwnProperty("transitions")&&d3.select(c).data()[0].transitions.forEach(function(n){n.target===t.name&&n.condition===e&&(e=!1)}),d3.selectAll("path.link#link_"+n.index+"_"+t.index).size()>0&&(u=!0),!e)return swal.showInputError("This condition already exists for the same transition"),!1;var f=e;o(i.force,i.getData,n,t,f),u?r(i.svg,i.force,n.index,t.index,f):(r(i.svg,i.force,n.index,t.index,f,"new"),d3.select("text.condition.link_"+n.index+"_"+t.index).on("click",function(e){s(e,i)})),n.graphicEditor.linking=!1,t.graphicEditor.linking=!1,d3.select(c).classed("linking",!1),d3.select(a).classed("linking",!1),d(i.getData),l.addToStack(i.getData),swal.close()})}}),define("editmode/edit_init",["require","menu/context_menu","editmode/edit_init","viewmode/view_init","editmode/cancel_all_selections","utility/undo","editmode/edit_frontend_object","editmode/global/get_global_edition","editmode/state/delete_state","editmode/state/delete_references","editmode/state/get_state_edition","editmode/state/get_state_name_edition","editmode/state/get_max_noise_edition","editmode/transition/get_condition","editmode/transition/get_transition_edition"],function(e){return{init:function(t,n,a,i){function o(e){_(e.index,b),g(a,e.name),m(a),f.addToStack(a)}function r(e){var t=!1,n="#state_"+e.index;d3.selectAll("circle").each(function(e){e.graphicEditor.linking&&(t=e)}),t?(d3.select(n).classed("linking",!0),w(e,t,n,b)):(e.graphicEditor.linking=!0,d3.select(n).classed("linking",!0))}function s(e){return e.graphicEditor.linking&&d3.select("#state_"+e.index).classed("editing")===!1&&1===d3.selectAll(".linking").size()}var l=e("menu/context_menu"),d=e("editmode/edit_init"),c=e("viewmode/view_init"),u=e("editmode/cancel_all_selections"),f=e("utility/undo"),m=e("editmode/edit_frontend_object"),p=e("editmode/global/get_global_edition"),_=e("editmode/state/delete_state"),g=e("editmode/state/delete_references"),h=e("editmode/state/get_state_edition"),v=e("editmode/state/get_state_name_edition"),x=e("editmode/state/get_max_noise_edition"),w=e("editmode/transition/get_condition"),y=e("editmode/transition/get_transition_edition"),b={svg:t,force:n,getData:a,links:i};d3.select("#global_properties").html("<button class='btn btn-primary button_edit_global_properties'>Edit global properties</button>"),d3.selectAll("#global_properties button").on("click",function(){p(b)}),d3.select("#svgbox").on("click",u),n.drag().on("drag",function(e){e.graphicEditor.unselectable=!0}),d3.selectAll("circle").each(function(){d3.select(this).on("contextmenu",function(e){switch(l){case"delete":o(e)}}).on("click",function(e){d3.event.stopPropagation(),d3.event.preventDefault(),e.graphicEditor.unselectable?e.graphicEditor.unselectable=!1:r(e)})}),d3.selectAll("text.state_name .state_name_label").each(function(){d3.select(this).on("click",function(e){v(e,b)})}),d3.selectAll("text.state_name .state_name_maxnoise").each(function(){d3.select(this).on("click",function(e){x(e,b)})}),d3.selectAll("text.condition").each(function(){d3.select(this).on("click",function(e){y(e,b)})}),d3.select(document).on("keyup",function(){if(d3.event.ctrlKey){var e;switch(d3.event.keyCode){case 90:var t=f.rollBack();t&&(e=c.init(c.extractStates([t]),t,!0),d.init(e.svg,e.force,e.getData,e.links),m(a));break;case 89:var n=f.rollForth();n&&(e=c.init(c.extractStates([n]),n,!0),d.init(e.svg,e.force,e.getData,e.links),m(a))}}else switch(d3.event.keyCode){case 27:u();break;case 46:d3.selectAll("circle").each(function(e){s(e)&&o(e)});break;case 69:d3.selectAll("circle").each(function(e){s(e)&&(d3.select("#state_"+e.index).classed("editing",!0),h(e,b))});break;case 77:d3.selectAll("circle").each(function(e){s(e)&&(d3.select("#state_"+e.index).classed("editing",!0),x(e,b))})}})}}}),define("data/data_example",[],function(){return[{allow_overlap:!0,states:{start:{max_noise:0,transitions:[{condition:"a",target:"start"},{condition:"b",target:"start"},{condition:"a",target:"s1"},{condition:"d",target:"s2"}]},s1:{transitions:[{condition:"b",target:"s1"},{condition:"c",target:"success"},{condition:"d",target:"error"}]},s2:{max_noise:4,transitions:[{condition:"d",target:"success"}]},success:{terminal:!0},error:{terminal:!0}}}]}),define("utility/server_request",["require","viewmode/view_init","viewmode/data_helper","editmode/edit_init","utility/utility","utility/undo","utility/server_request","data/data_example","viewmode/view_init","viewmode/data_helper","editmode/edit_init","utility/utility"],function(e){return{getRequest:function(t){function n(e,t){if(e){var n=JSON.parse(e),a=_.cloneDeep(n);switch(s.frontEndObject([n]),l.addToStack(n),t){case"view":i.init(i.extractStates([n]),n),$("button.reset").click(function(){var e=_.cloneDeep(a);i.init(i.extractStates([e]),e,!0),s.frontEndObject([o.cleanData(e)]),$("#object_container_left").css("background","transparent")});break;case"edit":var c=i.init(i.extractStates([n]),n);r.init(c.svg,c.force,c.getData,c.links),$("button.reset").click(function(){var e=_.cloneDeep(a),t=i.init(i.extractStates([e]),e);r.init(t.svg,t.force,t.getData,t.links),s.frontEndObject([o.cleanData(e)]),$("#object_container_left").css("background","transparent")});break;default:i.init(i.extractStates([n]),n)}$("button.save").click(function(){var e=o.cleanData(n);d.postRequest(e,t)})}}function a(t){console.log("/!\\ ajax : error retrieving data from server, local data loaded");var n=e("data/data_example"),a=_.cloneDeep(n);switch(s.frontEndObject(n),t){case"view":i.init(i.extractStates(n),n),$("button.reset").click(function(){var e=_.cloneDeep(a);i.init(i.extractStates([e]),e,!0),s.frontEndObject([o.cleanData(e)]),$("#object_container_left").css("background","transparent")});break;case"edit":var l=i.init(i.extractStates(n),n);r.init(l.svg,l.force,l.getData,l.links),$("button.reset").click(function(){var e=_.cloneDeep(a),t=i.init(i.extractStates([e]),e);r.init(t.svg,t.force,t.getData,t.links),s.frontEndObject([o.cleanData(e)]),$("#object_container_left").css("background","transparent")});break;default:i.init(i.extractStates(n),n)}}var i=e("viewmode/view_init"),o=e("viewmode/data_helper"),r=e("editmode/edit_init"),s=e("utility/utility"),l=e("utility/undo"),d=e("utility/server_request");$.ajax({type:"GET",url:"http://www.fsaeditor.com",success:function(e){return n(e,t)},error:function(){return a(t)},beforeSend:function(){$(".load_helper").show()},complete:function(){$(".load_helper").fadeOut(),$("#object_container_left").css("background","transparent")}})},postRequest:function(t,n){var a=e("viewmode/view_init"),i=e("viewmode/data_helper"),o=e("editmode/edit_init"),r=e("utility/utility");$.ajax({type:"POST",data:{graphicEditorFSA:JSON.stringify(t)},url:"http://www.fsaeditor.com",beforeSend:function(){$(".load_helper").fadeIn()},complete:function(){switch($(".load_helper").fadeOut(),$("#object_container_left").css("background","transparent"),d3.selectAll(".new_link").classed("new_link",!1),n){case"view":a.init(a.extractStates([t]),t,!0),r.frontEndObject([i.cleanData(t)]);break;case"edit":var e=a.init(a.extractStates([t]),t);o.init(e.svg,e.force,e.getData,e.links),r.frontEndObject([i.cleanData(t)])}},success:function(){swal("Saved!","JSON file successfully overwritten","success")},error:function(){console.log("send error")}})}}}),define("menu/menu",["require","utility/server_request"],function(e){var t=e("utility/server_request");-1!=location.href.indexOf("edit")?t.getRequest("edit"):-1!=location.href.indexOf("view")?t.getRequest("view"):$(document).ready(function(){$("body").prepend("<div class='menu'></div>"),$(".menu").html("<ul id='menu' class='list-group'><li id='view' class='list-group-item'><a href='#' class='list-group-item'>Mode vue</a></li><li id='edit' class='list-group-item'><a href='#' class='list-group-item'>Mode edition</a></li></ul>");for(var e,n,a=document.getElementById("menu").getElementsByTagName("li"),i=0;i<a.length;i++)e=document.getElementById(a[i].id),e.addEventListener("click",function(e){switch(n=this.id,e.preventDefault(),n){case"view":t.getRequest("view");break;case"edit":t.getRequest("edit");break;case"create":break;default:t.getRequest("view")}$(".menu").hide()})})}),define("../main",["require","menu/menu"],function(e){function t(e,t,n){$(e).toggleClass("closed"),$(t).hasClass("panel_closed")?$(t).html("left"===n?">":"<").prependTo(e):$(t).html("left"===n?"<":">").prependTo("body"),$(t).toggleClass("panel_closed")}e("menu/menu"),t("#object_container_wrapper","#object_container_close","left"),$("#object_container_close").click(function(){t("#object_container_wrapper","#object_container_close","left")}),t("#object_container_wrapper_left","#object_container_close_right","right"),$("#object_container_close_right").click(function(){t("#object_container_wrapper_left","#object_container_close_right","right")})}),require.config({baseUrl:"app/src/",paths:{data:"../../data",test:"../test/",jquery:"http://code.jquery.com/jquery-2.1.4.min",swal:"../../res/js/sweetalert.min"}}),require(["http://code.jquery.com/jquery-2.1.4.min.js","https://cdn.jsdelivr.net/lodash/3.10.1/lodash.js","swal","https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js","http://code.jquery.com/qunit/qunit-1.20.0.js","http://d3js.org/d3.v3.min.js","../main"]),define("app",function(){});